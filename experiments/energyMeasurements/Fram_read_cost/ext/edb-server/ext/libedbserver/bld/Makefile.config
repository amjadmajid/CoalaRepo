# This file applies the configuration, options are set in the top-level
# makefile of the app that links against this library. Available options are
# documented in Makefile.defaults.

THIS_DIR := $(dir $(abspath $(lastword $(MAKEFILE_LIST))))
include $(THIS_DIR)/Makefile.defaults

ifneq ($(VERBOSE),)
LOCAL_CFLAGS += -DVERBOSE=$(VERBOSE)
endif

ifeq ($(CONFIG_HOST_UART),1)
LOCAL_CFLAGS += -DCONFIG_HOST_UART
endif

ifeq ($(CONFIG_TARGET_UART),1)
LOCAL_CFLAGS += -DCONFIG_TARGET_UART

ifeq ($(CONFIG_TARGET_UART_PUSH),1)
LOCAL_CFLAGS += -DCONFIG_TARGET_UART_PUSH
endif

endif # CONFIG_TARGET_UART

ifeq ($(CONFIG_ENABLE_RF_PROTOCOL_MONITORING),1)
LOCAL_CFLAGS += -DCONFIG_ENABLE_RF_PROTOCOL_MONITORING

ifeq ($(CONFIG_RFID_DECODER_RUNTIME_BOUNDS),1)
LOCAL_CFLAGS += -DCONFIG_RFID_DECODER_RUNTIME_BOUNDS
endif

endif # CONFIG_ENABLE_RF_PROTOCOL_MONITORING

ifeq ($(CONFIG_ENABLE_I2C_MONITORING),1)
LOCAL_CFLAGS += -DCONFIG_ENABLE_I2C_MONITORING
endif

ifeq ($(CONFIG_SYSTICK),1)
LOCAL_CFLAGS += -DCONFIG_SYSTICK

ifeq ($(CONFIG_SYSTICK_32BIT),1)
LOCAL_CFLAGS += -DCONFIG_SYSTICK_32BIT
endif

endif # CONFIG_SYSTICK

ifeq ($(CONFIG_PWM_CHARGING),1)
LOCAL_CFLAGS += -DCONFIG_PWM_CHARGING
endif

ifeq ($(CONFIG_PULL_DOWN_ON_COMM_LINES),1)
LOCAL_CFLAGS += -DCONFIG_PULL_DOWN_ON_COMM_LINES
endif

# Enable code to decode RFID transmissions from the target
#
ifeq ($(CONFIG_ENABLE_RF_TX_DECODING),1)
LOCAL_CFLAGS += -DCONFIG_ENABLE_RF_TX_DECODING
endif

ifeq ($(CONFIG_DECODE_RFID_CMD_PAYLOAD),1)
LOCAL_CFLAGS += -DCONFIG_DECODE_RFID_CMD_PAYLOAD
endif

ifeq ($(CONFIG_SIG_SERIAL_DECODE_PINS),1)
LOCAL_CFLAGS += -DCONFIG_SIG_SERIAL_DECODE_PINS
endif

ifeq ($(CONFIG_SCOPE_TRIGGER_SIGNAL),1)
LOCAL_CFLAGS += -DCONFIG_SCOPE_TRIGGER_SIGNAL
endif

ifeq ($(CONFIG_ENABLE_PASSIVE_BREAKPOINTS),1)
LOCAL_CFLAGS += -DCONFIG_ENABLE_PASSIVE_BREAKPOINTS
endif

ifeq ($(CONFIG_ENABLE_WATCHPOINTS),1)
LOCAL_CFLAGS += -DCONFIG_ENABLE_WATCHPOINTS

ifneq ($(CONFIG_AUTO_ENABLED_WATCHPOINTS),)
LOCAL_CFLAGS += -DCONFIG_AUTO_ENABLED_WATCHPOINTS=$(CONFIG_AUTO_ENABLED_WATCHPOINTS)
endif # CONFIG_AUTO_ENABLED_WATCHPOINTS

endif # CONFIG_ENABLE_WATCHPOINTS

ifeq ($(CONFIG_ENABLE_WATCHPOINT_STREAM),1)

ifneq ($(CONFIG_ENABLE_WATCHPOINTS),1)
$(error CONFIG_ENABLE_WATCHPOINT_STREAM requires CONFIG_ENABLE_WATCHPOINTS)
endif

LOCAL_CFLAGS += -DCONFIG_ENABLE_WATCHPOINT_STREAM
endif

ifeq ($(CONFIG_ENABLE_DEBUG_MODE),1)
LOCAL_CFLAGS += -DCONFIG_ENABLE_DEBUG_MODE

ifeq ($(CONFIG_ENABLE_TARGET_SIDE_DEBUG_MODE),1)
LOCAL_CFLAGS += -DCONFIG_ENABLE_TARGET_SIDE_DEBUG_MODE
endif

ifeq ($(CONFIG_POWER_TARGET_IN_DEBUG_MODE),1)
LOCAL_CFLAGS += -DCONFIG_POWER_TARGET_IN_DEBUG_MODE
endif

ifeq ($(CONFIG_FETCH_INTERRUPT_CONTEXT),1)
LOCAL_CFLAGS += -DCONFIG_FETCH_INTERRUPT_CONTEXT
endif

ifeq ($(CONFIG_ENABLE_DEBUG_MODE_TIMEOUTS),1)
LOCAL_CFLAGS += -DCONFIG_ENABLE_DEBUG_MODE_TIMEOUTS
endif

endif # CONFIG_ENABLE_DEBUG_MODE

ifeq ($(CONFIG_RESET_STATE_ON_BOOT),1)
LOCAL_CFLAGS += -DCONFIG_RESET_STATE_ON_BOOT
endif

ifeq ($(CONFIG_ENABLE_VOLTAGE_STREAM),1)
LOCAL_CFLAGS += -DCONFIG_ENABLE_VOLTAGE_STREAM
endif

ifeq ($(CONFIG_ABORT_ON_HOST_UART_ERROR),1)
LOCAL_CFLAGS += -DCONFIG_ABORT_ON_HOST_UART_ERROR
endif

ifeq ($(CONFIG_ABORT_ON_RFID_EVENT_OVERFLOW),1)
LOCAL_CFLAGS += -DCONFIG_ABORT_ON_RFID_EVENT_OVERFLOW
endif

ifeq ($(CONFIG_STATE_PINS),1)
LOCAL_CFLAGS += -DCONFIG_STATE_PINS
endif

ifeq ($(CONFIG_EVENT_PINS),1)
LOCAL_CFLAGS += -DCONFIG_EVENT_PINS
endif

ifeq ($(CONFIG_RFID_DECODER_STATE_PINS),1)
LOCAL_CFLAGS += -DCONFIG_RFID_DECODER_STATE_PINS
endif

ifeq ($(CONFIG_BOOT_LED),1)
LOCAL_CFLAGS += -DCONFIG_BOOT_LED
endif

ifeq ($(CONFIG_DEBUG_MODE_LED),1)
LOCAL_CFLAGS += -DCONFIG_DEBUG_MODE_LED
endif

ifeq ($(CONFIG_ERROR_LED),1)
LOCAL_CFLAGS += -DCONFIG_ERROR_LED
endif

ifeq ($(CONFIG_CHARGE_MANIP),1)
LOCAL_CFLAGS += -DCONFIG_CHARGE_MANIP
endif

ifeq ($(CONFIG_TARGET_POWER_SWITCH),1)
LOCAL_CFLAGS += -DCONFIG_TARGET_POWER_SWITCH
endif

ifeq ($(CONFIG_WATCHDOG),1)
LOCAL_CFLAGS += -DCONFIG_WATCHDOG
endif

ifeq ($(CONFIG_DEV_CONSOLE),1)
LOCAL_CFLAGS += -DCONFIG_DEV_CONSOLE
endif

ifeq ($(CONFIG_ENABLE_WATCHPOINT_CALLBACK),1)
LOCAL_CFLAGS += -DCONFIG_ENABLE_WATCHPOINT_CALLBACK
endif

# Maker requires override
override CFLAGS += $(LOCAL_CFLAGS)
