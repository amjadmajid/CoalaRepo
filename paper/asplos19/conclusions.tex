Software for intermittently-powered energy-harvesting devices requires a dedicated runtime system. \sys is a new task-based system whose distinguishing feature is its adaptability to changing energy conditions at runtime. When more energy is available, \sys makes faster progress through the computation by coalescing statically-defined tasks. When less energy is available, progress is latched at sub-task granularity. \sys's virtual memory system ensures that program state in non-volatile memory remains consistent and amortizes the cost of state transfer between volatile and non-volatile memory. Our evaluation across applications on a real embedded energy-harvesting device demonstrates the utility of \sys, as well as the practicality of the proposed implementation.