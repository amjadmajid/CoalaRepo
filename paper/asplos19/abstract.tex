Energy-neutral Internet of Things requires freeing embedded devices from batteries and powering them from ambient energy. Ambient energy is, however, unpredictable and can only power a device intermittently. Therefore, the two paradigms of intermittent execution, program checkpointing and task-based programming, save the intermediate program state into non-volatile memory frequently to preserve the execution progress. Despite the superiority of the task-based approach over checkpointing, tasks' size is fixed at compile-time and agnostic to energy conditions. Thus, the state may be saved either more frequently than necessary or not frequently enough for the program to progress and terminate. To address these challenges, we propose \sys, an adaptive and efficient task-based execution model. \sys progresses on a multi-task scale when energy permits and preserves the computation progress on a sub-task scale if necessary. \sys's specialized memory virtualization mechanism ensures that power failures do not leave the program state in non-volatile memory inconsistent. Our evaluation on a real energy-harvesting platform not only shows that \sys reduces run time by up to 54\%, and by 26\% on average, as compared to a state-of-the-art system, but also it is able to \emph{progress} where static systems \emph{fail}.